<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover" />
  <title>TraderDuo ‚Äî Overview</title>
  <link rel="stylesheet" href="./system.css" />
</head>
<body>
  <input id="nav" hidden type="checkbox">

  <!-- Top bar -->
  <div class="top">
    <label class="hamb" for="nav">‚ò∞</label>
    <div class="brand">Trader<span style="color:var(--prime)">Duo</span></div>
    <div class="search"><input placeholder="Search accounts, positions, orders..." /></div>
    <button id="themeBtn" class="theme-toggle" title="Toggle light/dark">üåó Theme</button>
    <div class="status-indicator"><span>Live</span></div>
  </div>

  <div class="overlay"></div>

  <div class="layout">
    <!-- Sidebar -->
    <aside>
      <div class="nav-section">Dashboard</div>
      <a class="navbtn" href="index.html"><span>Overview</span></a>
      <a class="navbtn" href="copy.html"><span>Copy Trading</span></a>
      <a class="navbtn" href="journal.html"><span>Trading Journal</span></a>

      <div class="nav-section">Management</div>
      <a class="navbtn" href="settings.html"><span>Settings</span></a>

      <div style="margin-top:auto; display:grid; gap:10px;">
        <button class="btn danger" id="emergencyStop">üö® Emergency Stop</button>
        <button class="btn" id="closeAllPositions">Close All Positions</button>
        <button class="btn" id="cancelAllOrders">Cancel All Orders</button>
      </div>
    </aside>

    <!-- Main (Overview content) -->
    <main class="main">
      <section id="overview">
        <!-- Alert -->
        <div class="alert-card warning" id="correlationAlert">
          <div class="alert-icon">‚ö†Ô∏è</div>
          <div class="alert-content">
            <div class="alert-title">High Position Correlation Detected</div>
            <div class="alert-message">ESZ5 and NQZ5 positions are 89% correlated - consider reducing exposure</div>
          </div>
          <button class="btn xs" id="reviewCorrelation">Review</button>
        </div>

        <!-- Daily Loss Status -->
        <div class="loss-status profitable" id="lossStatus">
          <div class="loss-status-header">
            <div class="loss-status-title">Daily P&L Status</div>
            <div class="loss-status-value positive">PROFITABLE: +$581.06</div>
          </div>
          <div class="loss-progress">
            <div class="loss-progress-bar" style="width:0%; background:linear-gradient(90deg,var(--success),#10b981);"></div>
            <div class="loss-progress-text">Above Daily Limit - All Good!</div>
          </div>
          <div style="display:flex; justify-content:space-between; margin-top:8px; font-size:12px;">
            <span>Peak Drawdown: <strong style="color:var(--danger);">-$240</strong></span>
            <span>Time Remaining: <strong>6h 23m</strong></span>
            <span>Daily Limit: <strong>$1,500</strong></span>
          </div>
        </div>

        <!-- Total P&L -->
        <div class="card total-pnl" style="margin-bottom:20px;">
          <div style="display:flex; align-items:center; justify-content:space-between;">
            <div>
              <h3 style="margin:0; color:white;">Total P&L</h3>
              <div class="muted" style="font-size:12px;">Realized + Unrealized</div>
            </div>
            <div style="display:flex; align-items:center; gap:20px;">
              <div style="text-align:center;">
                <div id="totalPnL" class="kpi large" style="margin:0; color:white;">$581.06</div>
                <div class="kpi-change positive" id="totalChange">+8.7% today</div>
              </div>
              <div style="text-align:right;">
                <div class="risk-indicator low">Low Risk</div>
                <div class="muted" style="font-size:11px; margin-top:4px;">Risk Score: <span id="riskScore">92/100</span></div>
              </div>
            </div>
          </div>
          <div style="margin-top:16px; display:flex; gap:16px;">
            <div style="flex:1; padding:12px; background:rgba(255,255,255,0.05); border-radius:10px;">
              <div style="font-size:11px; color:var(--muted); margin-bottom:4px;">REALIZED TODAY</div>
              <div style="font-size:20px; font-weight:800; color:var(--danger);">-$76.05</div>
            </div>
            <div style="flex:1; padding:12px; background:rgba(255,255,255,0.05); border-radius:10px;">
              <div style="font-size:11px; color:var(--muted); margin-bottom:4px;">UNREALIZED</div>
              <div style="font-size:20px; font-weight:800; color:var(--success);">$657.11</div>
            </div>
          </div>
        </div>

        <!-- A couple of cards so app.js hooks have targets -->
        <div class="grid g-4">
          <div class="card">
            <h3>Risk Monitoring</h3>
            <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:12px;">
              <span style="font-size:14px; font-weight:600;">Margin Usage</span>
              <span style="font-size:16px; font-weight:800;">24.3%</span>
            </div>
            <div style="height:8px; background:var(--bg-secondary); border-radius:4px; overflow:hidden;">
              <div style="width:24.3%; height:100%; background:linear-gradient(90deg, var(--success), var(--warning)); border-radius:4px;"></div>
            </div>
            <div class="muted" style="font-size:11px; margin-top:8px;">Buying Power: $156,420 available</div>
          </div>

          <div class="card">
            <h3>Position Exposure</h3>
            <div id="kpiExposure" class="kpi" style="font-size:24px;">5 Positions</div>
            <div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
              <div class="position-chip">
                <span class="badge success">ESZ5 +2</span>
                <span class="position-close">√ó</span>
                <div class="position-tooltip">$142k notional (52% of portfolio)</div>
              </div>
              <div class="position-chip">
                <span class="badge success">NQZ5 +1</span>
                <span class="position-close">√ó</span>
                <div class="position-tooltip">$98.5k notional (36% of portfolio)</div>
              </div>
            </div>
          </div>

          <div class="card">
            <h3>Copy Trading Status</h3>
            <div style="display:flex; align-items:center; gap:12px; margin-bottom:12px;">
              <div id="kpiCopy" class="kpi" style="font-size:24px; color:var(--success); margin:0;">ACTIVE</div>
              <div class="sync-status">
                <div class="sync-dot healthy"></div><span>All synced</span>
              </div>
            </div>
            <div style="display:flex; justify-content:space-between; font-size:12px;">
              <span class="muted">Leaders: <strong>1</strong></span>
              <span class="muted">Followers: <strong>3</strong></span>
              <span class="muted">Latency: <strong>18ms</strong></span>
            </div>
          </div>

          <div class="card">
            <h3>Account Health</h3>
            <div style="display:grid; gap:8px;">
              <div style="display:flex; justify-content:space-between;"><span style="font-size:12px;">Total Balance</span><span style="font-weight:800;">$207,850</span></div>
              <div style="display:flex; justify-content:space-between;"><span style="font-size:12px;">Open P&L</span><span style="font-weight:800; color:var(--success);">+$657.11</span></div>
              <div style="display:flex; justify-content:space-between;"><span style="font-size:12px;">Day P&L</span><span style="font-weight:800; color:var(--danger);">-$76.05</span></div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <button class="quick-action" title="Emergency Stop" onclick="emergencyStopAll()">üö®</button>
    <button class="quick-action" title="Add Position" onclick="addPosition()">‚ûï</button>
    <button class="quick-action" title="Export Data" onclick="exportData()">üìä</button>
  </div>

  <!-- Correlation Modal (needed by Overview) -->
  <div class="modal-backdrop" id="correlationModalBackdrop"></div>
  <div class="modal" id="correlationModal">
    <div class="modal-card">
      <div class="modal-head">
        <h3>Position Correlation Analysis</h3>
        <button class="btn" onclick="closeModal('#correlationModal')">Close</button>
      </div>
      <div class="modal-body">
        <div>
          <h4>Pairwise Correlations (Last 24hr)</h4>
          <div class="correlation-item">
            <div><div style="font-weight:600;">ESZ5 ‚Üî NQZ5</div><div class="muted" style="font-size:12px;">High correlation detected</div></div>
            <div class="correlation-value high">89%</div>
          </div>
          <div class="correlation-item">
            <div><div style="font-weight:600;">ESZ5 ‚Üî CLX5</div><div class="muted" style="font-size:12px;">Low correlation</div></div>
            <div class="correlation-value low">-12%</div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" onclick="reducePosition('ESZ5')">Reduce ESZ5 by 1</button>
        <button class="btn danger" onclick="closePosition('NQZ5')">Close NQZ5</button>
        <button class="btn info">Set Correlation Limit</button>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
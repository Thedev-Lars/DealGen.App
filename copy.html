<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover" />
  <title>TraderDuo â€” Copy Trading</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="app.js"></script>
</head>
<body>
<input id="nav" hidden type="checkbox">

<div class="top">
  <label class="hamb" for="nav">â˜°</label>
  <div class="brand">Trader<span style="color:var(--prime)">Duo</span></div>
  <div class="search"><input placeholder="Search accounts, positions, orders..."></div>
  <button id="themeBtn" class="theme-toggle" title="Toggle light/dark">ðŸŒ— Theme</button>
  <div class="status-indicator"><span>Live</span></div>
</div>

<div class="overlay"></div>

<div class="layout">
  <aside>
    <div class="nav-section">Dashboard</div>
    <a class="navbtn" href="overview.html"><span>Overview</span></a>
    <a class="navbtn active" href="copy.html"><span>Copy Trading</span></a>
    <a class="navbtn" href="journal.html"><span>Trading Journal</span></a>

    <div class="nav-section">Management</div>
    <a class="navbtn" href="settings.html"><span>Settings</span></a>

    <div style="margin-top:auto;display:grid;gap:10px;">
      <button class="btn danger" id="emergencyStop">ðŸš¨ Emergency Stop</button>
      <button class="btn" id="closeAllPositions">Close All Positions</button>
      <button class="btn" id="cancelAllOrders">Cancel All Orders</button>
    </div>
  </aside>

  <main class="main">
    <!-- Copy Trading -->
    <section id="copy" data-page="copy" class="show" style="display:block;visibility:visible;">
      <div class="leader-group" id="leaderGroup1">
        <div class="leader-header" onclick="toggleLeaderGroup('leaderGroup1')">
          <div class="group-icon">ðŸ‘‘</div>
          <div class="group-title">Leader Group 1</div>
          <div class="group-stats">
            <span>4 accounts</span>
            <span>Total P&L: <strong style="color:var(--danger);">-$76.05</strong></span>
            <span>Status: <strong style="color:var(--success);">Active</strong></span>
          </div>
          <div class="expand-icon">â–¼</div>
        </div>

        <div class="follower-list">
          <!-- Leader -->
          <div class="account-card leader">
            <div class="account-header">
              <div class="account-info">
                <div class="account-name">TV-LEADER-203682037</div>
                <div class="account-meta">Leader Account â€¢ Connected via Tradovate API</div>
                <div class="account-stats">
                  <span>Balance: <strong>$52,377</strong></span>
                  <span>Day P&L: <strong style="color:var(--danger);">-$19.34</strong></span>
                  <span>Open P&L: <strong style="color:var(--success);">$167.11</strong></span>
                </div>
              </div>
              <div class="account-actions">
                <div class="sync-status"><div class="sync-dot healthy"></div><span>Active</span></div>
                <button class="btn sm" onclick="pauseAccount('TV-LEADER-203682037')">Pause</button>
                <button class="btn sm danger" onclick="removeAccount('TV-LEADER-203682037')">Remove</button>
              </div>
            </div>
          </div>

          <!-- Followers -->
          <div class="account-card follower">
            <div class="account-header">
              <div class="account-info">
                <div class="account-name">TV-FOLLOW-203682034</div>
                <div class="account-meta">Following: TV-LEADER-203682037 â€¢ Ratio: 1:1</div>
                <div class="account-stats">
                  <span>Balance: <strong>$50,307</strong></span>
                  <span>Day P&L: <strong style="color:var(--danger);">-$18.77</strong></span>
                  <span>Open P&L: <strong style="color:var(--success);">$162.14</strong></span>
                </div>
              </div>
              <div class="account-actions">
                <div class="sync-status"><div class="sync-dot healthy"></div><span>Synced</span></div>
                <button class="btn sm" onclick="editFollower('TV-FOLLOW-203682034')">Edit</button>
                <button class="btn sm" onclick="pauseAccount('TV-FOLLOW-203682034')">Pause</button>
                <button class="btn sm danger" onclick="removeAccount('TV-FOLLOW-203682034')">Remove</button>
              </div>
            </div>
          </div>

          <div class="account-card follower">
            <div class="account-header">
              <div class="account-info">
                <div class="account-name">TV-FOLLOW-203682035</div>
                <div class="account-meta">Following: TV-LEADER-203682037 â€¢ Ratio: 1:1</div>
                <div class="account-stats">
                  <span>Balance: <strong>$51,823</strong></span>
                  <span>Day P&L: <strong style="color:var(--danger);">-$18.89</strong></span>
                  <span>Open P&L: <strong style="color:var(--success);">$163.25</strong></span>
                </div>
              </div>
              <div class="account-actions">
                <div class="sync-status"><div class="sync-dot healthy"></div><span>Synced</span></div>
                <button class="btn sm" onclick="editFollower('TV-FOLLOW-203682035')">Edit</button>
                <button class="btn sm" onclick="pauseAccount('TV-FOLLOW-203682035')">Pause</button>
                <button class="btn sm danger" onclick="removeAccount('TV-FOLLOW-203682035')">Remove</button>
              </div>
            </div>
          </div>

          <div class="account-card follower">
            <div class="account-header">
              <div class="account-info">
                <div class="account-name">TV-FOLLOW-203682036</div>
                <div class="account-meta">Following: TV-LEADER-203682037 â€¢ Ratio: 1:1</div>
                <div class="account-stats">
                  <span>Balance: <strong>$53,342</strong></span>
                  <span>Day P&L: <strong style="color:var(--danger);">-$19.05</strong></span>
                  <span>Open P&L: <strong style="color:var(--success);">$164.61</strong></span>
                </div>
              </div>
              <div class="account-actions">
                <div class="sync-status"><div class="sync-dot delayed"></div><span>Delayed 2s</span></div>
                <button class="btn sm" onclick="editFollower('TV-FOLLOW-203682036')">Edit</button>
                <button class="btn sm" onclick="pauseAccount('TV-FOLLOW-203682036')">Pause</button>
                <button class="btn sm danger" onclick="removeAccount('TV-FOLLOW-203682036')">Remove</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Account Actions -->
      <div style="display:flex;gap:12px;margin-bottom:24px;">
        <button class="btn primary" id="addLeaderBtn">Add Leader Account</button>
        <button class="btn primary" id="addFollowerBtn">Add Follower Account</button>
      </div>

      <!-- Recent Orders -->
      <div class="card">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
          <h3 style="margin:0;">Recent Copy Orders</h3>
          <div style="display:flex;gap:8px;">
            <button class="btn sm">Filter Orders</button>
            <button class="btn sm">Export CSV</button>
          </div>
        </div>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Time</th><th>Leader</th><th>Followers</th><th>Symbol</th>
                <th>Side</th><th>Quantity</th><th>Price</th><th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>09:18:11</td>
                <td><code style="font-size:11px;">TV-LEADER-203682037</code></td>
                <td><span class="badge success">3 Copied</span></td>
                <td><span class="badge">ESZ5</span></td>
                <td><span class="badge success">Buy</span></td>
                <td>1</td>
                <td>$5,847.25</td>
                <td><span class="badge success">All Filled</span></td>
              </tr>
              <tr>
                <td>08:45:33</td>
                <td><code style="font-size:11px;">TV-LEADER-203682037</code></td>
                <td><span class="badge success">3 Copied</span></td>
                <td><span class="badge">NQZ5</span></td>
                <td><span class="badge success">Buy</span></td>
                <td>1</td>
                <td>$22,681.50</td>
                <td><span class="badge success">All Filled</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </main>
</div>

<!-- Edit Follower Modal -->
<div class="modal-backdrop" id="editFollowerModalBackdrop"></div>
<div class="modal" id="editFollowerModal">
  <div class="modal-card">
    <div class="modal-head">
      <h3 id="editFollowerTitle">Edit Follower Account</h3>
      <button class="btn" onclick="closeModal('#editFollowerModal')">Close</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Follow Leader</label>
        <select class="form-input" id="editLeaderSelect">
          <option>TV-LEADER-203682037</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Copy Ratio</label>
        <input class="form-input" id="editCopyRatio" placeholder="1.0">
      </div>
      <div class="form-group">
        <label class="form-label">Status</label>
        <select class="form-input" id="editStatus">
          <option>Active</option>
          <option>Paused</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Max Position Size</label>
        <input class="form-input" id="editMaxPosition" placeholder="$50,000">
      </div>
      <div class="form-group">
        <label class="form-label">Daily Loss Limit</label>
        <input class="form-input" id="editDailyLimit" placeholder="$500">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn" onclick="closeModal('#editFollowerModal')">Cancel</button>
      <button class="btn primary" onclick="saveFollowerEdit()">Save Changes</button>
    </div>
  </div>
</div>

<!-- Add Account Modal -->
<div class="modal-backdrop" id="addAccountModalBackdrop"></div>
<div class="modal" id="addAccountModal">
  <div class="modal-card">
    <div class="modal-head">
      <h3 id="addAccountTitle">Add Trading Account</h3>
      <button class="btn" onclick="closeModal('#addAccountModal')">Close</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label class="form-label">Account Type</label>
        <select class="form-input" id="accountType" onchange="toggleAccountFields()">
          <option>Leader Account</option>
          <option>Follower Account</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Account ID</label>
        <input class="form-input" placeholder="Enter Tradovate Account ID" id="accountId">
      </div>
      <div class="form-group" id="leaderSelectGroup" style="display:none;">
        <label class="form-label">Follow Leader</label>
        <select class="form-input" id="leaderSelect">
          <option>TV-LEADER-203682037</option>
        </select>
      </div>
      <div class="form-group" id="ratioGroup" style="display:none;">
        <label class="form-label">Copy Ratio</label>
        <input class="form-input" placeholder="1.0" id="copyRatio">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn" onclick="closeModal('#addAccountModal')">Cancel</button>
      <button class="btn primary" onclick="saveAccount()">Add Account</button>
    </div>
  </div>
</div>

<!-- Quick Actions -->
<div class="quick-actions">
  <button class="quick-action" title="Emergency Stop" onclick="emergencyStopAll()">ðŸš¨</button>
  <button class="quick-action" title="Add Position" onclick="addPosition()">âž•</button>
  <button class="quick-action" title="Export Data" onclick="exportData()">ðŸ“Š</button>
</div>
</body>
</html>